  <!-- Chart.js for plotting -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>VIO-HAR: Real-time Activity Prediction</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- roslibjs (CDN). If offline, you can download it into web/ and reference locally. -->
  <!-- Use jsdelivr CDN for roslibjs -->
  <script src="https://cdn.jsdelivr.net/npm/roslib@1.3.0/build/roslib.min.js"></script>
  <style>
    :root { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background: #0b0f19; color: #e6e8ec; }
    .wrap { max-width: 880px; margin: 40px auto; padding: 0 16px; }
    .card { background: #121829; border: 1px solid #1f2742; border-radius: 16px; padding: 20px; box-shadow: 0 6px 24px rgba(0,0,0,0.3); }
    h1 { font-size: 24px; margin: 0 0 12px; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; }
    .field { flex: 1 1 420px; }
    input[type=text] { width: 100%; padding: 12px 14px; background: #0d1324; border: 1px solid #2a355b; color: #e6e8ec; border-radius: 12px; outline: none; }
    button { padding: 12px 16px; border: 1px solid #2a355b; background: #1b2442; color: #e6e8ec; border-radius: 12px; cursor: pointer; }
    button:hover { background: #24315b; }
    .pill { display:inline-block; padding:6px 10px; border-radius: 999px; font-size:12px; border:1px solid #2a355b; }
    .ok { color:#00d084; border-color:#00d08433; background:#00d0840f; }
    .bad { color:#ff6b6b; border-color:#ff6b6b33; background:#ff6b6b0f; }
    .muted { color:#96a0bd; }
    .pred { font-size: 40px; font-weight: 700; letter-spacing: .5px; margin: 16px 0 8px; }
    .stream { background:#0d1324; border:1px solid #2a355b; border-radius:12px; padding:12px; height:180px; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:13px; }
    .footer { margin-top: 12px; font-size: 12px; color: #96a0bd; }
  </style>
</head>
<body>
  <!-- Loading Bar Overlay -->
  <div id="loadingOverlay" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(11,15,25,0.92);z-index:9999;display:none;align-items:center;justify-content:center;">
    <div style="text-align:center;">
      <div style="margin-bottom:18px;font-size:22px;color:#e6e8ec;font-weight:600;">Loading predictions</div>
      <div style="width:320px;height:18px;background:#1f2742;border-radius:9px;overflow:hidden;">
        <div id="loadingBar" style="height:100%;width:0%;background:#00d084;transition:width 0.7s;"></div>
      </div>
      <div style="margin-top:10px;color:#96a0bd;font-size:14px;">Waiting for first prediction or plot</div>
    </div>
  </div>
  <div class="wrap">
    <div class="card">
      <h1>VIO-HAR Web Control</h1>
      <p class="muted">Connects to ROS at <code>ws://localhost:9090</code> and streams <code>/activity_prediction</code>.</p>

      <div class="row" style="margin:12px 0 8px;">
        <div class="pill" id="connBadge">Connecting…</div>
      </div>

      <div class="row" style="margin:16px 0;">
        <div class="field">
          <label for="bag">Absolute bag file path</label>
          <input id="bag" type="text" placeholder="/home/you/data/run01.bag" />
        </div>
        <div class="row" style="align-items:flex-end;">
          <button id="runBtn">Run</button>
          <button id="stopBtn">Stop</button>
          <button id="clearBtn">Clear</button>
        </div>
      </div>
      <div id="predictionStatus" style="display:none;margin-bottom:12px;padding:10px 0;text-align:center;background:#00d084;color:#121829;border-radius:8px;font-size:18px;font-weight:500;">Prediction is working...</div>


      <div>
        <div id="gettingStarted" style="display:none;margin-bottom:12px;padding:10px 0;text-align:center;background:#24315b;color:#e6e8ec;border-radius:8px;font-size:18px;font-weight:500;">
          <span id="gettingStartedText">Getting Started</span><span id="gettingStartedDots">...</span>
        </div>
        <div class="muted">Latest prediction</div>
        <div class="pred" id="latestPred">—</div>
      </div>


      <div class="row" style="margin-top:24px; align-items: flex-start;">
        <div style="flex:1; min-width:320px; max-width:420px;">
          <div class="muted">Stream</div>
          <div class="stream" id="log" style="height:340px;"></div>
        </div>
        <div style="flex:2; min-width:320px;">
          <div class="muted">Odometry 3D Trajectory</div>
          <div class="stream" style="padding:0; height: 365px;; overflow:hidden;">
            <canvas id="odom3d" width="880" height="340" style="display:block;"></canvas>
          </div>
        </div>
      </div>

      <div style="margin-top:24px;">
        <div class="muted">Odometry 2D Plot (Time vs X)</div>
        <div class="stream" style="padding:0; height:180px; overflow:hidden;">
          <canvas id="plotX" width="880" height="180" style="display:block;"></canvas>
        </div>
      </div>

      <div style="margin-top:24px;">
        <div class="muted">Odometry 2D Plot (Time vs Y)</div>
        <div class="stream" style="padding:0; height:180px; overflow:hidden;">
          <canvas id="plotY" width="880" height="180" style="display:block;"></canvas>
        </div>
      </div>

      <div style="margin-top:24px;">
        <div class="muted">Odometry 2D Plot (Time vs Z)</div>
        <div class="stream" style="padding:0; height:180px; overflow:hidden;">
          <canvas id="plotZ" width="880" height="180" style="display:block;"></canvas>
        </div>
      </div>





      <div class="footer">Tip: Paste an <strong>absolute</strong> path (e.g., <code>/home/user/data/file.bag</code>) and click <strong>Run</strong>.</div>
    </div>
  </div>

  <!-- Add rosbridge library -->
<!-- Removed duplicate roslibjs script -->

<!-- Load three.js as a global object for compatibility -->
<script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>

<!-- Then your app code -->
<script type="module" src="app.js"></script>

</body>
</html>
